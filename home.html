<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather Analytics - Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles/main.css" />
  </head>

  <body
    class="bg-gradient-to-br from-indigo-50 to-blue-100 dark:from-gray-900 dark:to-gray-800 dark:text-white text-slate-900 antialiased transition-colors duration-300"
  >
    <header
      class="fixed top-0 left-0 w-full bg-white/30 dark:bg-gray-900/30 backdrop-blur z-40 shadow-sm"
    >
      <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
        <a href="index.html" class="flex items-center gap-3">
          <img
            src="assets/logo.svg"
            alt="logo"
            class="h-8 w-8 drop-shadow-md"
          />
          <span class="font-semibold text-lg">Weather Analytics</span>
        </a>

        <nav class="hidden md:flex gap-6 text-sm font-medium">
          <a
            href="home.html"
            class="hover:text-indigo-600 dark:hover:text-indigo-400"
            >Home</a
          >
          <a
            href="dashboard.html"
            class="hover:text-indigo-600 dark:hover:text-indigo-400"
            >Dashboard</a
          >
          <a
            href="about.html"
            class="hover:text-indigo-600 dark:hover:text-indigo-400"
            >About</a
          >
          <a
            href="login.html"
            class="hover:text-indigo-600 dark:hover:text-indigo-400"
            >Login</a
          >
        </nav>

        <button
          id="themeToggle"
          class="ml-4 p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-xl shadow hover:scale-110 transition"
        >
          ðŸŒ™
        </button>

        <!-- Mobile Hamburger -->
        <button
          id="mobileMenuBtn"
          class="md:hidden p-2 rounded-md bg-gray-200 dark:bg-gray-700"
        >
          â˜°
        </button>
      </div>

      <!-- Mobile Menu -->
      <nav
        id="mobileMenu"
        class="hidden md:hidden absolute top-full left-0 w-full bg-white dark:bg-gray-800 shadow-lg flex flex-col gap-2 p-4 z-50"
      >
        <a
          href="home.html"
          class="hover:text-indigo-600 dark:hover:text-indigo-400"
          >Home</a
        >
        <a
          href="dashboard.html"
          class="hover:text-indigo-600 dark:hover:text-indigo-400"
          >Dashboard</a
        >
        <a
          href="about.html"
          class="hover:text-indigo-600 dark:hover:text-indigo-400"
          >About</a
        >
        <a
          href="login.html"
          class="hover:text-indigo-600 dark:hover:text-indigo-400"
          >Login</a
        >
      </nav>
    </header>

    <main class="pt-24 md:pt-28 max-w-6xl mx-auto p-4">
      <section
        class="bg-white dark:bg-gray-800 shadow rounded-xl p-6 text-center mb-6"
      >
        <h2 class="text-xl md:text-2xl font-bold mb-2">
          Welcome Back
          <span id="userName" class="text-indigo-600">User</span> ðŸ‘‹
        </h2>
        <p class="text-slate-600 dark:text-white text-sm md:text-base">
          Your weather insights & analytics at a glance!
        </p>
      </section>

      <section class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div
          class="bg-white p-4 shadow rounded-xl h-[320px] sm:h-[360px] md:h-[400px] relative"
        >
          <h3 class="text-sm text-slate-500 mb-2">Temperature Overview</h3>

          <div
            id="tempSpinner"
            class="absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-gray-900/50 z-10"
          >
            <svg
              class="animate-spin w-10 h-10 text-indigo-600 dark:text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
              ></path>
            </svg>
          </div>

          <canvas id="homeTempChart" class="w-full h-full"></canvas>
        </div>

        <div
          class="bg-white p-4 shadow rounded-xl h-[320px] sm:h-[360px] md:h-[400px] relative"
        >
          <h3 class="text-sm text-slate-500 mb-2">Precipitation Overview</h3>

          <div
            id="rainSpinner"
            class="absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-gray-900/50 z-10"
          >
            <svg
              class="animate-spin w-10 h-10 text-indigo-600 dark:text-white"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
              ></path>
            </svg>
          </div>

          <canvas id="homeRainChart" class="w-full h-full"></canvas>
        </div>
      </section>
    </main>

    <script>
      tailwind.config = { darkMode: "class" };
    </script>

    <script src="./scripts/theme.js"></script>
    <script src="./scripts/mobilemenu.js"></script>

    <script type="module">
      import { initRouter } from "./scripts/router.js";
      initRouter();
    </script>

    <script type="module">
      import { checkAuth } from "./scripts/auth.js";
      import { fetchWeather } from "./scripts/api.js";
      import { initCharts } from "./scripts/charts.js";

      window.addEventListener("DOMContentLoaded", async () => {
        document.getElementById("userName").textContent = "Demo User";

        const tempSpinner = document.getElementById("tempSpinner");
        const rainSpinner = document.getElementById("rainSpinner");

        const tempCtx = document
          .getElementById("homeTempChart")
          ?.getContext("2d");
        const rainCtx = document
          .getElementById("homeRainChart")
          ?.getContext("2d");

        const data = await fetchWeather("Toronto");
        if (!data) return;

        tempSpinner.classList.add("hidden");
        rainSpinner.classList.add("hidden");

        initCharts(tempCtx, rainCtx, data.weather);
      });
    </script>
  </body>
</html>